---
title: "Educational Data vs Gross Domestic Product Analysis"
output:
  html_document:
    keep_md: true
---
```{r echo=FALSE}
Data = read.table(file.path("data", "merged_data.csv"), header = TRUE, encoding='UTF-8')
```

#Introduction
The world economy is accelerating at a rapid pace. Influencing factors looked at by the World Bank, the world's largest development institution, are climate change, conflict, food security, education, agriculture, finance, and trade.  Questions are being asked about the investment and result of education as indicators of a country's Gross Domestic Product (GDP).

The data source for this analysis is from the World Bank's Education Statistics (http://datatopics.worldbank.org/education/) web site.  While the World Bank looks at many indicators across all levels of education, this analysis will focus on the aggregate of all education levels with no specific break out for attributes of the student (gender, age, etc).  

It is important to note that the World Bank's Education Statistics (EDSstat) does differentiate between countries that participate in the Organization of Economic Cooperation and Development (OECD). The OECD was founded in 1960 and contains 35 member countries today, including the United States, United Kingdom, and Germany.  The goal of this organization is to help developing countries create and sustain economic prosperity.  In this analysis, the  "Income Group" used in the ranking of GDP for a country does contain an indicator of whether the country is part of the OECD. 

This analysis takes a closer look at the relationship between GDP and overall education across OECD and non OECD countries.



###1. With the merged data frame how many IDs matched?

When we merged the Educational data with the GDP data we were bound to have some that did not match.
The number that we ended up mathing together is listed below.
```{r}
nrow(Data)
```
###2. With the the data frame in decending order by GDP(United States last) what is the 13th value?

```{r}
# reorder by GDP
Data = Data[order(Data$GDP),]
# print 13-th
print(Data[c(13), ])
```

###3. What are the average GDP rankings for the "High income: OECD" and "High Income:nonOECD" groups?

Comments
```{r}
Data$GDP.rankings = rank(Data$GDP)
OECD_rankings = Data$GDP.rankings[Data$Income.Group == "High income: OECD"]
print(mean(OECD_rankings))
nonOECD_rankings = Data$GDP.rankings[Data$Income.Group == "High income: nonOECD"]
print(mean(nonOECD_rankings))
```
###4. 1	Plot the GDP for all of the countries. Use ggplot2 to color your plot by Income Group.

Comments
```{r kable}
# install ggplot2 and scales in case its not
if("ggplot2" %in% rownames(installed.packages()) == FALSE){
  install.packages("ggplot2", repos = structure(c(CRAN = "http://cran.r-project.org")))
}
if("scales" %in% rownames(installed.packages()) == FALSE){
  install.packages("scales", repos = structure(c(CRAN = "http://cran.r-project.org")))
}
# load the packages
require(ggplot2)
require(scales)  # allows for setting up the ggplot

options(scipen=10000)  # gets rid of the exponential numbers on the Y axis

ggplot (Data, aes(x=Data$Income.Group, y=Data$GDP)) + # sets up GGPLOT2 scatter plot
  scale_y_continuous(name="GDP -- In USD$ Millions", labels= scales::comma, expand = c(0,0), limits=c(0, 20000000), breaks=seq(0,18000000, 2000000))  + #sets up Y axis with labels
  scale_x_discrete ("Income Group", labels = c("Low income" = "LI", "High income: nonOECD" = "nHI", "High income: OECD" = "oHI", "Lower middle income" = "LMI", "Upper middle income" = "UMI")) + # sets up x axis for abbreviates of categorical variable to prevent overlap and promote readability
  theme (aspect.ratio = 2/1) + #sets up aspect ratio so consistent with each output
  geom_point(aes(color = Data$Income.Group)) +  #sets up colored points
  scale_color_discrete (name="Income Group") #changes legend title
cat ("\n") # This pushes #5 below to the next line and allows the diagram to stand alone.
```   

###5. Cut the GDP rankings into 5 seperate quantile groups. Making a table versus income group.
###   How many countries are "lower middle income" but within the 38 nations with the highest GDP?

Comments
```{r}
# install dplyr in case its not
if("dplyr" %in% rownames(installed.packages()) == FALSE){
  install.packages("dplyr", repos = structure(c(CRAN = "http://cran.r-project.org")))
}
# load dplyr
library(dplyr)
# ntile is a function from dplyr
# ntile will split the rankings to 5 quantile groups
Data$QuantGroup <- ntile(Data$GDP.rankings, 5)
# I dont know what this means: Make a table versus Income.Group
#     is this is?
knitr::kable(Data[c('QuantGroup', 'Income.Group')])
top38 <- tail(Data, n = 38)
# this answer: How many countries are "lower middle income" but within the 38 nations with the highest GDP
print(NROW(top38[top38$Income.Group == 'Lower middle income', ]))
```

Conclusion